<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Community - Not HermitCraft SMP</title>
  <link rel="icon" type="image/png" href="../media/favicon.png" />
  <link rel="stylesheet" href="../media/style.css" />
  <link href="https://fonts.bunny.net/css?family=Space+Grotesk:wght@500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
</head>

<body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../media/navigation.js"></script>
  
  <!-- Navigation containers - content will be dynamically generated -->
  <div id="desktop-nav-container"></div>
  <div id="mobile-nav-container"></div>
  <div class="mainflex">
    <div class="main1 community-bg">
      <div class="main1_description">
        <h1 class="community-main-title">Our Amazing Community</h1>
        <p class="community-main-subtitle">Connect with us across all platforms and discover our incredible content creators</p>
      </div>

      <div id="community"></div>
      
      <!-- Community Links & Content Creators Section -->
      <div class="main5">
        <div class="community-section">
          
          <!-- Social Media & Links -->
          <div class="community-links">
            <h3 class="community-subsection-title">Find Us Everywhere</h3>
            <div class="social-links">
              <a href="https://www.planetminecraft.com/server/nothermitcraft/" target="_blank" class="social-link planetmc">
                <div class="social-icon">üåç</div>
                <div class="social-info">
                  <h4>Planet Minecraft</h4>
                  <p>Check out our server page and vote for us!</p>
                </div>
              </a>
              <a href="#" class="social-link youtube coming-soon">
                <div class="social-icon">üì∫</div>
                <div class="social-info">
                  <h4>NHC SMP YouTube</h4>
                  <p>Coming Soon! Subscribe for server events and highlights</p>
                </div>
              </a>
              <a href="https://discord.com/invite/nothermitcraft" target="_blank" class="social-link discord">
                <div class="social-icon">üí¨</div>
                <div class="social-info">
                  <h4>Discord Server</h4>
                  <p>Join our community for chat, events, and applications</p>
                </div>
              </a>
            </div>
          </div>

          <!-- Content Creators Spotlight -->
          <div class="content-creators">
            <h3 class="community-subsection-title">Featured Content Creators</h3>
            <p class="creators-description">Amazing community members who regularly share their builds, adventures, and creativity!</p>
            <div class="creators-grid" id="creators-grid">
              <!-- Creators will be dynamically loaded here -->
            </div>

            <!-- Call to Action for Content Creators -->
            <div class="creator-cta">
              <h4>Are you a content creator?</h4>
              <p>We love supporting our community creators! If you regularly post content about NHC SMP, reach out to our staff team on Discord to get featured here and receive special perks!</p>
              <a href="https://discord.com/invite/nothermitcraft" class="creator-apply-btn">Apply to be Featured</a>
            </div>
          </div>

          <!-- Server Statistics or Additional Info -->
          <div class="server-highlights">
            <h3 class="community-subsection-title">Why Join NHC SMP?</h3>
            <div class="highlights-grid">
              <div class="highlight-item">
                <div class="highlight-icon">üë•</div>
                <h4>Active Community</h4>
                <p>Friendly players from around the world</p>
              </div>
              <div class="highlight-item">
                <div class="highlight-icon">üèóÔ∏è</div>
                <h4>Amazing Builds</h4>
                <p>Incredible structures and collaborative projects</p>
              </div>
              <div class="highlight-item">
                <div class="highlight-icon">üéÆ</div>
                <h4>Regular Events</h4>
                <p>Community games, contests, and special occasions</p>
              </div>
              <div class="highlight-item">
                <div class="highlight-icon">üìú</div>
                <h4>Rich Lore</h4>
                <p>Ever-expanding world with deep history and stories built by the community!</p>
              </div>
            </div>
          </div>

          <!-- Community Stats Section -->
          <div class="community-stats">
            <h3 class="community-subsection-title">Community at a Glance</h3>
            <div class="stats-grid">
              <div class="stat-item">
                <div class="stat-number">5+</div>
                <div class="stat-label">Years Running</div>
              </div>
              <div class="stat-item">
                <div class="stat-number">50+</div>
                <div class="stat-label">Active Members</div>
              </div>
              <div class="stat-item">
                <div class="stat-number">1000+</div>
                <div class="stat-label">Amazing Builds</div>
              </div>
              <div class="stat-item">
                <div class="stat-number">24/7</div>
                <div class="stat-label">Server Uptime</div>
              </div>
            </div>
          </div>

          <!-- Join Call to Action -->
          <div class="community-join-cta">
            <h3>Ready to Join Our Community?</h3>
            <p>Start your journey with us today! Join our Discord to apply for whitelist and become part of the NHC SMP family.</p>
            <div class="cta-buttons">
              <a href="https://discord.com/invite/nothermitcraft" class="cta-btn primary">Join Discord</a>
              <a href="../index.html#join" class="cta-btn secondary">How to Join</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer class="copyright_div">
    <a href="https://github.com/FQQD/MCServer-Web-Template" class="copyright">Made by FQQD 2023 - Edited by Dakota -
      HeruEdhel 2025</a>
  </footer>

  <script>
    // Function to extract channel ID from YouTube URL
    function extractYouTubeChannelId(url) {
      const patterns = [
        /youtube\.com\/channel\/(UC[\w-]+)/,
        /youtube\.com\/@([\w-]+)/,
        /youtube\.com\/c\/([\w-]+)/,
        /youtube\.com\/user\/([\w-]+)/
      ];
      
      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match) return { type: pattern === patterns[0] ? 'channel' : 'handle', id: match[1] };
      }
      return null;
    }

    // Function to extract Twitch username from URL
    function extractTwitchUsername(url) {
      const match = url.match(/twitch\.tv\/([\w-]+)/);
      return match ? match[1] : null;
    }

    // Function to get profile picture for YouTube channels
    async function getYouTubeProfilePicture(channelUrl) {
      try {
        const channelInfo = extractYouTubeChannelId(channelUrl);
        if (!channelInfo) return null;

        // For YouTube channels, we can try several approaches
        if (channelInfo.type === 'channel' && channelInfo.id.startsWith('UC')) {
          // Try the direct YouTube avatar URL pattern
          const avatarUrl = `https://yt3.ggpht.com/ytc/AIdro_${channelInfo.id.substring(2)}/s88-c-k-c0x00ffffff-no-rj`;
          
          // Test if the image exists
          return new Promise((resolve) => {
            const img = new Image();
            img.onload = () => resolve(avatarUrl);
            img.onerror = () => resolve(null);
            img.src = avatarUrl;
          });
        }

        // For handles and other formats, try a different approach
        try {
          // Use a simple proxy service to get channel info
          const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(`https://www.youtube.com/c/${channelInfo.id}`)}`;
          const response = await fetch(proxyUrl);
          
          if (response.ok) {
            const html = await response.text();
            // Extract profile picture from the HTML
            const avatarMatch = html.match(/"avatar":{"thumbnails":\[{"url":"([^"]+)"/);
            if (avatarMatch) {
              return avatarMatch[1];
            }
          }
        } catch (proxyError) {
          console.log('Proxy method failed:', proxyError);
        }

        return null;
      } catch (error) {
        console.log('Could not fetch YouTube profile picture:', error);
        return null;
      }
    }

    // Function to get profile picture for Twitch channels
    async function getTwitchProfilePicture(twitchUrl) {
      try {
        const username = extractTwitchUsername(twitchUrl);
        if (!username) return null;

        // Try to fetch from a CORS-friendly endpoint
        // Note: This would require a backend service or API key in production
        // For now, we'll return null to fall back to FontAwesome icons
        return null;
      } catch (error) {
        console.log('Could not fetch Twitch profile picture:', error);
        return null;
      }
    }

    // Function to create creator avatar element
    async function createCreatorAvatar(creator) {
      const avatarContainer = document.createElement('div');
      avatarContainer.classList.add('creator-avatar');

      let profilePicUrl = null;

      // First, check if there's a manual avatar URL in the data
      if (creator.avatarUrl) {
        profilePicUrl = creator.avatarUrl;
      } else {
        // Try to get profile picture based on platform
        if (creator.platform === 'YouTube' && creator.link) {
          profilePicUrl = await getYouTubeProfilePicture(creator.link);
        } else if (creator.platform === 'Twitch' && creator.link) {
          profilePicUrl = await getTwitchProfilePicture(creator.link);
        }
      }

      if (profilePicUrl) {
        // Create image element for profile picture
        const img = document.createElement('img');
        img.src = profilePicUrl;
        img.alt = `${creator.name} profile picture`;
        img.classList.add('creator-profile-img');
        
        // Add error handling to fall back to icon
        img.onerror = function() {
          console.log(`Failed to load profile picture for ${creator.name}, falling back to icon`);
          avatarContainer.innerHTML = `<i class="fa ${creator.icon}"></i>`;
        };
        
        avatarContainer.appendChild(img);
      } else {
        // Fall back to FontAwesome icon
        avatarContainer.innerHTML = `<i class="fa ${creator.icon}"></i>`;
      }

      return avatarContainer;
    }

    // Load and display random content creators
    fetch('../data/creators.json')
      .then(response => response.json())
      .then(async data => {
        const creatorsGrid = document.getElementById('creators-grid');
        const allCreators = [...data.creators, ...data.placeholders];
        
        // Function to get random creators
        function getRandomCreators(creators, count) {
          const shuffled = creators.sort(() => 0.5 - Math.random());
          return shuffled.slice(0, count);
        }
        
        // Get 3 random creators
        const randomCreators = getRandomCreators(allCreators, 3);
        
        // Create creator cards
        for (const creator of randomCreators) {
          const creatorCard = document.createElement('div');
          creatorCard.classList.add('creator-card');
          
          // Add special styling for real creators vs placeholders
          if (creator.featured) {
            creatorCard.classList.add('featured-creator');
          } else {
            creatorCard.classList.add('placeholder-creator');
          }

          // Create avatar (this will be async)
          const avatarElement = await createCreatorAvatar(creator);
          
          // Create the card content
          const cardContent = document.createElement('div');
          cardContent.classList.add('creator-info');
          cardContent.innerHTML = `
            <h4>${creator.name}</h4>
            <p class="creator-type">${creator.type} ‚Ä¢ ${creator.platform}</p>
            <p>${creator.description}</p>
            <span class="creator-note">${creator.note}</span>
          `;

          // Assemble the card
          creatorCard.appendChild(avatarElement);
          creatorCard.appendChild(cardContent);
          
          // Add click functionality for real creators
          if (creator.link && creator.link.trim() !== '') {
            creatorCard.style.cursor = 'pointer';
            creatorCard.addEventListener('click', () => {
              window.open(creator.link, '_blank');
            });
            creatorCard.setAttribute('title', `Visit ${creator.name} on ${creator.platform}`);
          }
          
          creatorsGrid.appendChild(creatorCard);
        }
      })
      .catch(error => {
        console.error('Error loading creators:', error);
        // Fallback to show placeholder cards if JSON fails to load
        const creatorsGrid = document.getElementById('creators-grid');
        creatorsGrid.innerHTML = `
          <div class="creator-card placeholder-creator">
            <div class="creator-avatar">
              <i class="fa fa-video-camera"></i>
            </div>
            <div class="creator-info">
              <h4>Your Channel Here!</h4>
              <p class="creator-type">Content Creation ‚Ä¢ Any Platform</p>
              <p>Create content about NHC SMP and get featured!</p>
              <span class="creator-note">Apply in Discord</span>
            </div>
          </div>
          <div class="creator-card placeholder-creator">
            <div class="creator-avatar">
              <i class="fa fa-camera"></i>
            </div>
            <div class="creator-info">
              <h4>Build Showcases</h4>
              <p class="creator-type">Photography ‚Ä¢ Social Media</p>
              <p>Share your amazing builds and get spotlighted</p>
              <span class="creator-note">Tag us on social media</span>
            </div>
          </div>
          <div class="creator-card placeholder-creator">
            <div class="creator-avatar">
              <i class="fa fa-twitch"></i>
            </div>
            <div class="creator-info">
              <h4>Stream with Us</h4>
              <p class="creator-type">Live Content ‚Ä¢ Streaming</p>
              <p>Stream your gameplay and community events</p>
              <span class="creator-note">Contact staff for features</span>
            </div>
          </div>
        `;
      });
  </script>
</body>

</html>
